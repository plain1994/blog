<!DOCTYPE html>
<html lang="ch" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Reading Summary of Dynamic Routing Between Capsules - tomgou.xyz</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <link href="http://blog.tomgou.xyz/images/carrot.jpg" rel="icon">

<link rel="canonical" href="http://blog.tomgou.xyz/reading-summary-of-dynamic-routing-between-capsules.html">

        <meta name="author" content="Tom Gou" />
        <meta name="keywords" content="Capsule,CNN" />
        <meta name="description" content="Reading Summary of Dynamic Routing Between Capsules" />

        <meta property="og:site_name" content="tomgou.xyz" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Reading Summary of Dynamic Routing Between Capsules"/>
        <meta property="og:url" content="http://blog.tomgou.xyz/reading-summary-of-dynamic-routing-between-capsules.html"/>
        <meta property="og:description" content="Reading Summary of Dynamic Routing Between Capsules"/>
        <meta property="article:published_time" content="2018-03-16" />
            <meta property="article:section" content="Blogs" />
            <meta property="article:tag" content="Capsule" />
            <meta property="article:tag" content="CNN" />
            <meta property="article:author" content="Tom Gou" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://blog.tomgou.xyz/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="http://blog.tomgou.xyz/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://blog.tomgou.xyz/theme/css/pygments/native.css" rel="stylesheet">
    <link href="http://blog.tomgou.xyz/theme/tipuesearch/tipuesearch.css" rel="stylesheet">
    <link rel="stylesheet" href="http://blog.tomgou.xyz/theme/css/style.css" type="text/css"/>





</head>
<body>

<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://www.tomgou.xyz/" class="navbar-brand">
tomgou.xyz            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                        <li class="active">
                            <a href="http://blog.tomgou.xyz/category/blogs.html">Blogs</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><span>
                <form class="navbar-search" action="/search.html">
                  <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input" required>
                </form></span>
              </li>
              <li><a href="http://blog.tomgou.xyz/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<style>
	#banner{
	    background-image:url("http://blog.tomgou.xyz/images/saul.jpg");
	}
</style>

<div id="banner">
	<br />
	<br />
	<br />
	<br />
	<br />
	<br />
	<br />
	<br />
	<br />
	<br />
	<br />
	
</div><!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://blog.tomgou.xyz/reading-summary-of-dynamic-routing-between-capsules.html"
                       rel="bookmark"
                       title="Permalink to Reading Summary of Dynamic Routing Between Capsules">
                        Reading Summary of Dynamic Routing Between Capsules
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2018-03-16T20:20:00+08:00"> Fri 16 March 2018</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="http://blog.tomgou.xyz/tag/capsule.html">Capsule</a>
        /
	<a href="http://blog.tomgou.xyz/tag/cnn.html">CNN</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <h3>1. Introduction</h3>
<p>This paper proposed a novel neural network architecture called capsule network that combined a group of neuron to construct a capsule and dynamically connect these capsules by the correlation between two capsules. </p>
<p>This paper is inspired by human vision system, like a hierarchical tree structure. Neurons will only pass the information to the part of the brain which can best handled the information. The defaults of CNN are also the motivation of this paper. Traditional CNN uses multiple layers of filters to achieve translation invariance. Max-pooling layers throw away a lot of necessary information of an object, such as positions and orientations.</p>
<p>Capsule neural network uses “activity vectors” to learn the pose of an object, such as position and orientations, while CNN throws these low level details of an object away through max-pooling layer and only learns shapes and colors. And iterative dynamic routing provides an alternative of calculating how a capsule is activated by using local features’ properties. </p>
<p>The paper used “squashing” function as the non-linear activation function, because this function can be used to the vector instead of normal scalar. And the iterative dynamic routing process determined coupling coefficients of prediction vectors.</p>
<p>CapsNet consists of 3 layer and an additional reconstruction loss. The first layer is ReLU Conv1 (a convolution layer with 9x9 kernels output 256 channels, stride 1, no padding with ReLU). The second layer is PrimaryCapsules (a convolution capsule layer with 9x9 kernel output 32x6x6 8-D capsule, stride 2, no padding). The final layer is DigitCaps (Capsule output computed from a Wij (16x8 matrix) between ui and vj (i from 1 to 32x6x6 and j from 1 to 10). The architecture of reconstruction consists of FC1 (Fully connected with ReLU of size 512), FC2 (Fully connected with ReLU of size 1024) and FC sigmoid (Fully connected with sigmoid of size 784 [28x28 image]).</p>
<p>The proposed capsule neural network architecture was trained with both MNIST and MultiMNIST dataset that consists of pictures of overlapping digits. Both of the experiments achieved better performance comparing with CNN models that have similar parameter sizes.</p>
<h3>2. Related Work</h3>
<p>(1))    “Learning to parse images” by Geoffrey E Hinton et al.</p>
<p>(2) “Transforming auto-encoders” by Geoffrey E Hinton et al.</p>
<p>(3) “Adam: A method for stochastic optimization” by Kingma and Ba.</p>
<p>(4) “A parallel computation that assigns canonical object-based frames of reference” by Geoffrey E Hinton. </p>
<p>(5) “Crowding is unlike ordinary masking: Distinguishing feature integration from detection” by Denis G Pelli et al.</p>
<p>(6) “Spatial transformer networks” by Max Jaderberg et al. </p>
<p>(7) “A neurobiological model of visual attention and invariant pattern recognition based on dynamic routing of information” by Bruno A Olshausen et al. </p>
<h3>3. Strong Points</h3>
<p>(1) The paper use capsules instead of two normal layers. Capsules allow vector input and output, and the length of the output vector can represent the probability that the entity represented by the capsule is present in the current input.</p>
<p>(2) This activate function is applied to non-linearization of capsules. Instead of normal activate function for scalar, squad can be applied to vector.</p>
<p>(3) Applying margin loss instead of cross entropy to allow for multiple digits.</p>
<p>(4) CapsNet uses only 3 layers and get a low test error of 0.25% that was only achieved by deeper networks.</p>
<p>(5) CapsNet is moderately robust to affine transformations, it achieved 79% accuracy on the affnist test set (each example is an MINIST with a random small affine transformation), 13% better than the traditional model’s accuracy.</p>
<p>(6) Adding the reconstruction regularizer accelerate the routing performance by enforcing the encoding in the capsule vector.</p>
<h3>4. Weak Points</h3>
<p>(1) The paper would have been more completed if it discusses the limitations of the CapsNet design.</p>
<p>(2) The paper could have some explanation on the reason of not adding more capsule layers to improve the performance.</p>
<p>(3) The paper didn’t mention how many experiments were performed on the same dataset. The results could have been more faithful if they were supported by significant set of experiments instead of just once.</p>
<h3>5. Follow-ups</h3>
<p>Hinton published a new paper “MATRIX CAPSULES WITH EM ROUTING”, it show some new ideas like make capsule using matrix and a new routing algorithm.</p>
<h3>6. New Ideas</h3>
<p>(1) Remove the convolutional network in capsnet instead of using capsules.</p>
<p>(2) Improve routing algorithm because the original routing algorithm is too simple for larger neural network.</p>
<p>(3) Improve the clustering learning in unsupervised learning study by routing-by-agreement.</p>
<p>Reference:</p>
<p>[1] <a href="https://blog.csdn.net/maltliquor/article/details/78422557?locationNum=10&amp;fps=1">https://blog.csdn.net/maltliquor/article/details/78422557?locationNum=10&amp;fps=1</a></p>
<p>[2] <a href="https://blog.csdn.net/zchang81/article/details/78382472">https://blog.csdn.net/zchang81/article/details/78382472</a></p>
<p>[3] <a href="https://www.zhihu.com/question/67287444">https://www.zhihu.com/question/67287444</a></p>
            </div>
            <!-- /.entry-content -->
            
    <hr />
    <!-- AddThis Button BEGIN -->
    <!-- Go to www.addthis.com/dashboard to customize your tools -->
    <div class="addthis_sharing_toolbox"></div>
    <!-- Go to www.addthis.com/dashboard to customize your tools -->
    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-56d3af0e9a805928"></script>
    <!-- AddThis Button END -->

<!-- 多说评论框 start -->
    <div class="ds-thread"  data-url="blog.tomgou.xyz/reading-summary-of-dynamic-routing-between-capsules.html"></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"tomgou"};
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
         || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
    </script>
<!-- 多说公共JS代码 end -->
            
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>

<section class="well well-sm">
    <ul class="list-group list-group-flush">
            <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
              <ul class="list-group" id="social">
                <li class="list-group-item"><a href="https://github.com/plain1994"><i class="fa fa-github-square fa-lg"></i> github</a></li>
                <li class="list-group-item"><a href="http://weibo.com/tomgou"><i class="fa fa-weibo fa-lg"></i> weibo</a></li>
                <li class="list-group-item"><a href="http://www.facebook.com/yuchuangou"><i class="fa fa-facebook-square fa-lg"></i> facebook</a></li>
              </ul>
            </li>

            <li class="list-group-item"><a href="http://blog.tomgou.xyz/"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
                <ul class="list-group list-inline tagcloud" id="tags">
                    <li class="list-group-item tag-2">
                        <a href="http://blog.tomgou.xyz/tag/basic.html">
                            basic
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.tomgou.xyz/tag/capsule.html">
                            Capsule
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.tomgou.xyz/tag/cc.html">
                            C/C++
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://blog.tomgou.xyz/tag/cnn.html">
                            CNN
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.tomgou.xyz/tag/cudav8.html">
                            CUDAv8
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.tomgou.xyz/tag/cudnn.html">
                            CUDNN
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.tomgou.xyz/tag/fibonacci-heap.html">
                            Fibonacci heap
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.tomgou.xyz/tag/hadoop.html">
                            Hadoop
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.tomgou.xyz/tag/installation.html">
                            Installation
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.tomgou.xyz/tag/intellij-idea.html">
                            IntelliJ IDEA
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.tomgou.xyz/tag/java.html">
                            Java
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.tomgou.xyz/tag/py-faster-rcnn.html">
                            py-faster-rcnn
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.tomgou.xyz/tag/pycharm.html">
                            PyCharm
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.tomgou.xyz/tag/pyspark.html">
                            pyspark
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.tomgou.xyz/tag/python.html">
                            Python
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.tomgou.xyz/tag/scala.html">
                            Scala
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://blog.tomgou.xyz/tag/spark.html">
                            Spark
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://blog.tomgou.xyz/tag/ubuntu.html">
                            Ubuntu
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://blog.tomgou.xyz/tag/windows.html">
                            Windows
                        </a>
                    </li>
                </ul>
            </li>

    <li class="list-group-item"><h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
      <ul class="list-group" id="links">
        <li class="list-group-item">
            <a href="http://getpelican.com/" target="_blank">
                Pelican
            </a>
        </li>
      </ul>
    </li>
        




    <li class="list-group-item"><h4><i class="fa fa-github fa-lg"></i><span class="icon-label">GitHub Repos</span></h4>
        <div id="gh_repos">
            <p class="list-group-item">Status updating...</p>
        </div>
    </li>
        
        <script type="text/javascript" src="//rf.revolvermaps.com/0/0/6.js?i=5i7e91zcj7e&amp;m=6&amp;s=240&amp;c=ff0000&amp;cr1=ffffff&amp;f=ubuntu&amp;l=0" async="async"></script>
    </ul>
</section>
            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2018 Yuchuan Gou
            &middot; Powered by 
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>,
            <a href="https://www.python.org" target="_blank">Python</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://blog.tomgou.xyz/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://blog.tomgou.xyz/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://blog.tomgou.xyz/theme/js/respond.min.js"></script>

    <script src="http://blog.tomgou.xyz/theme/js/bodypadding.js"></script>
    <!-- GitHub JS -->
    <script type="text/javascript">
        $(document).ready(function () {
            if (!window.jXHR) {
                var jxhr = document.createElement('script');
                jxhr.type = 'text/javascript';
                jxhr.src = 'http://blog.tomgou.xyz/theme/js/jXHR.js';
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(jxhr, s);
            }

            github.showRepos({
                user: 'plain1994',
                count: 3,
                skip_forks: false,
                target: '#gh_repos'
            });
        });
    </script>
    <script src="http://blog.tomgou.xyz/theme/js/github.js" type="text/javascript"></script>
    <!-- End GitHub JS Code -->
    <!-- Google Analytics -->
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-74218843-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>
    <!-- End Google Analytics Code -->



</body>
</html>